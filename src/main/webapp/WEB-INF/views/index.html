<!DOCTYPE html>
<!-- saved from url=(0032)http://127.0.0.1:8080/webapp/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>云上城·进销存</title>
	<!-- easyui皮肤 -->
	<link href="/webapp/static/base/easyui/themes/icon.css" rel="stylesheet" type="text/css" />

	<!-- 自定义easyUI皮肤 -->
	<link href="/webapp/static/base/frame/css/metro-blue/easyui.css" rel="stylesheet" type="text/css" />
	<link href="/webapp/static/base/frame/css/icon.css" rel="stylesheet" type="text/css" />
	<link href="/webapp/static/base/frame/css/style.css" rel="stylesheet" type="text/css" />
	<link href="/webapp/static/base/frame/css/jquery.loadmask.css" rel="stylesheet" type="text/css" />
	<link href="/webapp/static/base/frame/css/form.css" rel="stylesheet" type="text/css" />

	<!-- 扩展样式 -->
	<link href="/webapp/static/base/css/common_ex.css" rel="stylesheet" type="text/css" />

	<script src="/webapp/static/base/js/jquery-1.11.1.min.js" type="text/javascript"></script>
	<script src="/webapp/static/base/easyui/jquery.easyui.min.js" type="text/javascript"></script>

	<!-- My97插件 -->
	<script type="text/javascript" src="/webapp/static/base/plugins/My97DatePicker/WdatePicker.js"></script>
	<script type="text/javascript" src="/webapp/static/base/easyui/extensions/jquery.my97.js"></script>
	<link href="/webapp/static/base/easyui/themes/default/my97.css" rel="stylesheet" type="text/css" />

	<script src="/webapp/static/base/easyui/locale/easyui-lang-zh_CN.js" type="text/javascript"></script>

	<script src="/webapp/static/base/ex/common_ex.js" type="text/javascript"></script>
	<script type="text/javascript" src="/webapp/static/base/ex/jquery.loadmask.min.js"></script>

	<script src="/webapp/static/common/js/jquery.rotate.min.js"></script>

	<script src="/webapp/static/common/js/common.js"></script>
	<script>
		window.addEventListener('message',function(e){
			window.onbeforeunload = null;
			window.location.replace('/webapp');
		},false);
	</script>



</head>
<body>
<!--mleft-menu-two-->
<div id="menu_two" class="uhide menu-two">
	<div class="menu-two-item ub ub-ver" >
		<div class="item-title">基础信息</div>
		<div class="item-list ub ub-ver">
			<ul class="menu-two-ul" >
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
			</ul>
		</div>
	</div>
	<div class="menu-two-item ub ub-ver" >
		<div class="item-title">基础信息</div>
		<div class="item-list ub ub-ver">
			<ul class="menu-two-ul" >
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
			</ul>
		</div>
	</div>
	<div class="menu-two-item ub ub-ver" >
		<div class="item-title">基础信息</div>
		<div class="item-list ub ub-ver">
			<ul class="menu-two-ul" >
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
				<li>分店区域</li>
			</ul>
		</div>
	</div>
</div><!--end left-menu-two-->

<div class="basic-header">
	<div class="logo">
		<a href="http://127.0.0.1:8080/webapp/#"><img src="/webapp/static/base/frame/images/logo.png"> <span style="font-size: 20px;">进销存</span></a>
	</div><!--end logo -->
    
    <div class="header-load">
    	<a class="header-load-link"><span class="name">fms_admin,您好</span> <i class="iconfont"></i></a>
        <div class="linkdiv">
        	<a href="http://127.0.0.1:8080/webapp/logout">退出</a>
        </div><!--end linkdiv -->
    </div><!--end header-load -->
</div><!--end header -->

<div class="basic-body">
	<div class="left-big-menu">
		<div class="scroll-y-box" id="leftMenuContent">
			<div class="big-menu-switch"><i class="iconfont"></i></div>
			<div class="menu-box">
				<!--<div class="menu-title"><i class="iconfont"></i><span>系统管理</span></div>-->
				<ul class="menu-trans" abc="4">
					<li class="menu-one">
						<a href="javascript:openNewTab('采购订单','html/POSheet.html','icon-hamburg-left');">
							<i class="iconfont"></i>
							<span>采购订单</span>
						</a>
					</li>
					<li class="menu-one">
						<a href="javascript:openNewTab('商品档案','html/basItemList.html','icon-hamburg-left');">
							<i class="iconfont"></i>
							<span>商品档案</span>
						</a>
					</li>
					<li class="menu-one">
						<a href="javascript:openNewTab('二级菜单3','#','icon-hamburg-left');">
							<i class="iconfont"></i>
							<span>二级菜单3</span>
						</a>
					</li>
					<li class="menu-one">
						<a href="javascript:openNewTab('二级菜单4','#','icon-hamburg-left');">
							<i class="iconfont"></i>
							<span>二级菜单4</span>
						</a>
					</li>
				</ul>
			</div>
		</div><!--end scroll-y-box -->
    </div><!--end left-big-menu-->

    <div class="basic-right basic-right-active">
        <div class="left-small-menu">
            <h2 class="tit" id="childMenuName">二级菜单01</h2>
            <div class="scroll-y-box small-menu-list" id="childMenuContent">
            </div><!--end small-menu-list -->
        </div><!--end left-small-menu -->
        
        <div class="sma-menu-switch none" id="collapseIcon">
            <span class="bg">&nbsp;</span>
            <div class="con">
                <i class="iconfont switch-ico-left"></i>
                <i class="iconfont switch-ico-right"></i>
            </div><!--end con -->
        </div><!--end big-menu-switch -->
        
        <div class="basic-main">
            <div class="scroll-y-box basic-main-content panel-noscroll">
				<!--start内容区 -->
            	<div id="component-content" class="easyui-tabs tabs-container easyui-fluid" fit="true" border="false" style="width: 1740px; height: 861px;">
                <div class="tabs-header tabs-header-noborder" style="width: 1740px;"><div class="tabs-scroller-left" style="display: none;"></div><div class="tabs-scroller-right" style="display: none;"></div><div class="tabs-wrap" style="margin-left: 0px; margin-right: 0px; width: 1740px;"><ul class="tabs" style="height: 27px;"></ul></div></div><div class="tabs-panels tabs-panels-noborder" style="height: 832px; width: 1740px;"></div></div>  
				<!--end 内容区 -->
            </div><!--end scroll-y-box -->
        </div><!--end basic-main -->
	</div><!--end basic-right -->    
</div><!--end basic-body -->



<script type="text/javascript">
//


$(function(){
	$('.menu-one,.menu-two').bind('mouseleave',function(){
		$('.menu-two').addClass('uhide')
	});
	$('.menu-two').bind('mouseenter',function(){
		$('.menu-two').removeClass('uhide')
	});
	$('.menu-one').bind('mouseenter',function(){
		console.log($(this).width());//
		$('.menu-two').removeClass('uhide').css('top',$(this).offset().top);
		$('.menu-two').removeClass('uhide').css('left',$(this).width());
	});
	//顶部右侧登录
	$(".header-load-link").on("click",function(){
		addActive("header-load");
	});
	//左侧大菜单关闭打开
	collapseLeftMenu();
	//左侧子菜单关闭打开
	collapseChildMenu();
	//绑定tab页关闭
	tabClose();
	//绑定tab页右键菜单
	tabMenuEven();
	//tree
	//$.fn.zTree.init($("#treeDemo"), setting, zNodes);
});
//一二级菜单面板收缩功能
function collapseLeftMenu(){
	$(".big-menu-switch").on("click",function(){
		addActive("basic-body");
		$("#component-content").tabs("resize");//内容区最外层的组件尺寸刷新
	});
}
//三级子菜单收缩功能
function collapseChildMenu(){
	$(".sma-menu-switch").on("click",function(){
		addActive("basic-right");
		$("#component-content").tabs("resize");//内容区最外层的组件尺寸刷新
	});
}
//一级子菜单收缩功能
function clickMenuItem(){
	//二级菜单选中样式
	$(".menu-trans li").on("click",function(){
		$(".menu-trans li").removeClass("active");
		$(this).addClass("active");
	});
	
	//二级菜单收缩功能
	$(".menu-title").on("click",function(){
		parentState(this,"menu-box-active");
	});
}
//三、四级菜单选中Click
function clickChildMenuItem(){
	$(".small-menu-list a.link, .small-menu-list a.sma-link").on("click",function(){
		//三、四级菜单选中样式
		$(".small-menu-list a.link, .small-menu-list a.sma-link").removeClass("active");
		$(this).addClass("active");
		
		//收缩四级菜单功能
		parentState(this,"menu-showchild");
	});
}

//显示 折叠按钮
function showCollapseIcon(){
	$("#collapseIcon").removeClass("none");
}

//隐藏 折叠按钮
function hideCollapseIcon(){
	$("#collapseIcon").addClass("none");
}

function currentState(id,name){
	if(!id.hasClass(name)){
		id.addClass(name);
	}else{
		id.removeClass(name);
	}
}

function addActive(name){
	var objName = "." + name;
	var activeName = name +"-active";
	if($(objName).hasClass(activeName)){
		$(objName).removeClass(activeName);
	}else{
		$(objName).addClass(activeName);
	}
}

function parentState(obj,name){
	var parent = $(obj).parent();
	if(parent.hasClass(name)){
		parent.removeClass(name);
	}else{
		parent.addClass(name);
	}	
}
var menuData;
function loadLeftMenu(){
	$.ajax({
	    async:false,
	    type:'get',
	    url:"/webapp/system/permission/i/json",
	    success: function(data){
	    	
	    	if(data == null || data.length == 0){
	    		alert("您没有该系统的访问权限！");
	    		window.location='/webapp/logout';
	    		return ;
	    	}
	    	//data = initData; 
	    	menuData = data;
	    	var menuHtml = "";
	    	
	    	//一、二级菜单折叠 
	   		menuHtml += 	"<div class=\"big-menu-switch\"><i class=\"iconfont\">&#xe611;</i></div>";
	   		
	   		//循环一级菜单 begin
	    	$(data).each(function(i){
	    		var o = this;
	    			//一级菜单父节点ID为null
   		   			menuHtml += "<div class=\"menu-box\">";
   		   			
   		   			//一级菜单
   		   			menuHtml += 	"<div class=\"menu-title\">";
   		   			menuHtml +=			"<i class=\"iconfont\">&#xe606;</i>"; 
   		   			menuHtml +=			"<span>"+o.name+"</span>";
   		   			menuHtml +=		"</div>";
   		   			
   		   			//二级菜单
   		   			menuHtml +=	"<ul class=\"menu-trans\" abc=\""+i+"\">";
		   			
		   			//循环二级菜单 begin
		   			$(o.children).each(function(j){
		   				var p = this;
				   			
		   					//二级菜单01，有子菜单，有三级菜单，即无URL的 
		   					if(!p.isleaf){
		   						menuHtml += "<li>";
		   						menuHtml += 	"<a href=\"javascript:openChildMenu('"+p.id+"');\">";
		   						menuHtml += 		"<i class=\"iconfont\">&#xe613;</i>";
		   						menuHtml +=			"<span>"+p.name+"</span>";
		   						menuHtml +=		"</a>";
		   						menuHtml +=	"</li>";
		   						
		   					} else {	//二级菜单02，无子菜单，仅有二级，即有URL的
		   						menuHtml += "<li>";
		   						menuHtml += 	"<a href=\"javascript:openNewTab(\'"+p.name+"\',\'"+p.url+"\',\'"+p.icon+"\');\">";
		   						menuHtml += 		"<i class=\"iconfont\">&#xe613;</i>";	//TODO 需要动态构建icon样式，目前默认iconfont
		   						menuHtml +=			"<span>"+p.name+"</span>";
		   						menuHtml +=		"</a>";
		   						menuHtml +=	"</li>";
		   						
		   					}
		   					
		   			});
		   			//循环二级菜单 end
		   			
		   			menuHtml +=	"</ul>";
		   			
		   			menuHtml +=	"</div>";
   		 	});
	    	//循环一级菜单 end
	    	
	    	$("#leftMenuContent").html(menuHtml);
	    	
	    	//一级子菜单收缩功能
	    	clickMenuItem();
	    }
	});
}

//打开三级菜单面板，加载三级菜单
function openChildMenu(id){
	var menu;
	var data = menuData;
	$(data).each(function(i){
		var o = this;
		$(o.children).each(function(j){
			var p = this;
			if (id == p.id) {
				menu = p;
			}
		});
	});
	
	
	//二级菜单名称
	$("#childMenuName").text(menu.name);
		
	var menuHtml = "";
	menuHtml += "<ul>";
	//循环三级菜单 begin
	$(menu.children).each(function(k){
		
		var q = this;
			
			//三级菜单01，有子菜单，有四级菜单，即无URL的 
			if(!q.isleaf){
				
				//加载三级菜单 
				menuHtml +=	"<li class=\"menu-showchild\">";
				
				menuHtml +=		"<a class=\"link\"><i class=\"iconfont\">&#xe60b;</i> "+q.name+"</a>";
				
				//四级菜单容器
				menuHtml +=		"<div class=\"linkdiv\">";
						
				//循环四级菜单 begin
				$(q.children).each(function(l){
					var r = this;
					//加载四级菜单
					menuHtml +=	"<a href=\"javascript:addTab(\'"+r.name+"\',\'"+r.url+"\',\'"+r.icon+"\');\" class=\"sma-link\">"+r.name+"</a>";
					
				});//循环四级菜单 end
				
				menuHtml +=		"</div>";
				menuHtml +=	"</li>";
				
			} else {		//三级菜单02，无子菜单，仅有二级，即有URL的
				
				//加载三级菜单
				menuHtml += "<li><a class=\"link\" href=\"javascript:addTab(\'"+q.name+"\',\'"+q.url+"\',\'"+q.icon+"\');\">"+q.name+"</a></li>";
				
			}
		
	}); //循环三级菜单 end
	
	menuHtml += "</ul>";
	$("#childMenuContent").html(menuHtml);
	
	//三、四级菜单选中事件
	clickChildMenuItem();
	
	//显示三级菜单面板
	$(".basic-right").removeClass("basic-right-active");
	
	//显示折叠按钮
	showCollapseIcon();
	
	$("#component-content").tabs("resize");//内容区最外层的组件尺寸刷新
}


function openNewTab(subtitle, url, icon){
	
	//隐藏三级菜单面板
	$(".basic-right").addClass("basic-right-active");
	
	//隐藏折叠按钮
	hideCollapseIcon();
	
	//新增tab页
	addTab(subtitle, url, icon);
	
	$("#component-content").tabs("resize");//内容区最外层的组件尺寸刷新
}

function addTab(subtitle, url, icon) {
	if (!$('#component-content').tabs('exists', subtitle)) {
		$('#component-content').tabs('add', {
			title : subtitle,
			content : createFrame(url),
			closable : true
			//icon : icon	tab图标暂时不用
		});
	} else {
		
		//刷新tab页
		$('#component-content').tabs('select', subtitle);
		var currTab = $('#component-content').tabs('getSelected');
		$('#component-content').tabs('update', {
			tab : currTab,
			options : {
				content : createFrame(url)
			}
		});
	}
	tabClose();
}

function selectTab(subtitle){
	$('#component-content').tabs('select', subtitle);
}

function createFrame(url) {
	var s = '<iframe scrolling="auto" frameborder="0"  src="' + url + '" style="width:100%;height:99%;"></iframe>';
	return s;
}

function tabClose() {
	/* 双击关闭TAB选项卡 */
	$(".tabs-inner").dblclick(function() {
		var subtitle = $(this).children(".tabs-closable").text();
		$('#component-content').tabs('close', subtitle);
	});
	/* 为选项卡绑定右键 */
	$(".tabs-inner").bind('contextmenu', function(e) {
		$('#mm').menu('show', {
			left : e.pageX,
			top : e.pageY
		});

		var subtitle = $(this).children(".tabs-closable").text();

		$('#mm').data("currtab", subtitle);
		$('#component-content').tabs('select', subtitle);
		return false;
	});
}

function refluseTabByTitle(subtitle){
	var selectTab = $('#component-content').tabs('getTab', subtitle);
	var url = $(selectTab.panel('options').content).attr('src');
	
	//刷新页面
	addTab(subtitle, url, null);
}

function getTabByTitle(subtitle){
	var tab = $('#component-content').tabs('getTab', subtitle);
	return tab;
}

function closeTab(subtitle){
	if(!subtitle){
		var currTab = $('#component-content').tabs('getSelected');
		subtitle = currTab.panel("options").title;
	}
	$('#component-content').tabs('close', subtitle);
}

// 绑定右键菜单事件
function tabMenuEven() {
	// 刷新
	$('#mm-tabupdate').click(function() {
		var currTab = $('#component-content').tabs('getSelected');
		var url = $(currTab.panel('options').content).attr('src');
		$('#component-content').tabs('update', {
			tab : currTab,
			options : {
				content : createFrame(url)
			}
		});
	});
	
	//复制subtitle, url, icon
	/* $('#mm-tabrepeat').click(function() {
		var currTab = $('#component-content').tabs('getSelected');
		var currTabPanel = currTab.panel('options');
		var url = $(currTab.panel('options').content).attr('src');
		var subtitle = currTabPanel.title;
		var icon = currTabPanel.iconCls;
		
		addTab(subtitle, url, icon);
	}); */
	
	// 关闭当前
	$('#mm-tabclose').click(function() {
		closeTab();
	});
	// 全部关闭
	$('#mm-tabcloseall').click(function() {
		$('.tabs-inner span').each(function(i, n) {
			var t = $(n).text();
			$('#component-content').tabs('close', t);
		});
	});
	// 关闭除当前之外的TAB
	$('#mm-tabcloseother').click(function() {
		$('#mm-tabcloseright').click();
		$('#mm-tabcloseleft').click();
	});
	// 关闭当前右侧的TAB
	$('#mm-tabcloseright').click(function() {
		var nextall = $('.tabs-selected').nextAll();
		if (nextall.length == 0) {
			// msgShow('系统提示','后边没有啦~~','error');
			alert('后边没有啦~~');
			return false;
		}
		nextall.each(function(i, n) {
			var t = $('a:eq(0) span', $(n)).text();
			$('#component-content').tabs('close', t);
		});
		return false;
	});
	// 关闭当前左侧的TAB
	$('#mm-tabcloseleft').click(function() {
		var prevall = $('.tabs-selected').prevAll();
		if (prevall.length == 0) {
			alert('到头了，前边没有啦~~');
			return false;
		}
		prevall.each(function(i, n) {
			var t = $('a:eq(0) span', $(n)).text();
			$('#component-content').tabs('close', t);
		});
		return false;
	});

	// 退出
	$("#mm-exit").click(function() {
		$('#mm').menu('hide');
	});
}
	
</script>
<div id="mm" class="easyui-menu menu-top menu" style="width: 120px; height: 184px; overflow: hidden; display: none; left: 0px; top: 0px;"><div class="menu-line" style="height: 182px;"></div>
	<div id="mm-tabupdate" class="menu-item" style="height: 22px;"><div class="menu-text" style="height: 20px; line-height: 20px;">刷新</div></div>
	<!-- <div id="mm-tabrepeat">复制</div> -->
	<div class="menu-sep"></div>
	<div id="mm-tabclose" class="menu-item" style="height: 22px;"><div class="menu-text" style="height: 20px; line-height: 20px;">关闭</div></div>
	<div id="mm-tabcloseall" class="menu-item" style="height: 22px;"><div class="menu-text" style="height: 20px; line-height: 20px;">全部关闭</div></div>
	<div id="mm-tabcloseother" class="menu-item" style="height: 22px;"><div class="menu-text" style="height: 20px; line-height: 20px;">关闭其它</div></div>
	<div class="menu-sep"></div>
	<div id="mm-tabcloseright" class="menu-item" style="height: 22px;"><div class="menu-text" style="height: 20px; line-height: 20px;">关闭右侧</div></div>
	<div id="mm-tabcloseleft" class="menu-item" style="height: 22px;"><div class="menu-text" style="height: 20px; line-height: 20px;">关闭左侧</div></div>
	<div class="menu-sep"></div>
	<div id="mm-exit" class="menu-item" style="height: 22px;"><div class="menu-text" style="height: 20px; line-height: 20px;">退出</div></div>
</div>
</body>
</html>